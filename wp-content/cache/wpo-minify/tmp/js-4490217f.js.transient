{"request":{"hurl":"http:\/\/f934-222-252-24-15.ngrok-free.app\/wp-content\/themes\/cfa99\/assets\/tradding.js","inline":"","enable_minification":true,"type":"js","handle":"trading_script","version":false},"log":{"url":"\/wp-content\/themes\/cfa99\/assets\/tradding.js","success":true},"code":"var COLOR_PURPLE=\"#B64FF5\",COLOR_YELLOW=\"#FEC703\",COLOR_BLUE_ACCESS=\"#48C1CC\",COLOR_GREEN=\"#60B523\",COLOR_RED=\"#E63124\"\nvar RESULT_PRICE={}\nvar codeStock='';async function callApi(endPoint,method,isToken=!0,body,isJson=!1){var myHeaders=new Headers();var requestOptions={method:method,redirect:'follow',};if(isToken){myHeaders.append(\"Authorization\",\"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSIsImtpZCI6IkdYdExONzViZlZQakdvNERWdjV4QkRITHpnSSJ9.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4iLCJhdWQiOiJodHRwczovL2FjY291bnRzLmZpcmVhbnQudm4vcmVzb3VyY2VzIiwiZXhwIjoxODg5NjIyNTMwLCJuYmYiOjE1ODk2MjI1MzAsImNsaWVudF9pZCI6ImZpcmVhbnQudHJhZGVzdGF0aW9uIiwic2NvcGUiOlsiYWNhZGVteS1yZWFkIiwiYWNhZGVteS13cml0ZSIsImFjY291bnRzLXJlYWQiLCJhY2NvdW50cy13cml0ZSIsImJsb2ctcmVhZCIsImNvbXBhbmllcy1yZWFkIiwiZmluYW5jZS1yZWFkIiwiaW5kaXZpZHVhbHMtcmVhZCIsImludmVzdG9wZWRpYS1yZWFkIiwib3JkZXJzLXJlYWQiLCJvcmRlcnMtd3JpdGUiLCJwb3N0cy1yZWFkIiwicG9zdHMtd3JpdGUiLCJzZWFyY2giLCJzeW1ib2xzLXJlYWQiLCJ1c2VyLWRhdGEtcmVhZCIsInVzZXItZGF0YS13cml0ZSIsInVzZXJzLXJlYWQiXSwianRpIjoiMjYxYTZhYWQ2MTQ5Njk1ZmJiYzcwODM5MjM0Njc1NWQifQ.dA5-HVzWv-BRfEiAd24uNBiBxASO-PAyWeWESovZm_hj4aXMAZA1-bWNZeXt88dqogo18AwpDQ-h6gefLPdZSFrG5umC1dVWaeYvUnGm62g4XS29fj6p01dhKNNqrsu5KrhnhdnKYVv9VdmbmqDfWR8wDgglk5cJFqalzq6dJWJInFQEPmUs9BW_Zs8tQDn-i5r4tYq2U8vCdqptXoM7YgPllXaPVDeccC9QNu2Xlp9WUvoROzoQXg25lFub1IYkTrM66gJ6t9fJRZToewCt495WNEOQFa_rwLCZ1QwzvL0iYkONHS_jZ0BOhBCdW9dWSawD6iF1SIQaFROvMDH1rg\");requestOptions.headers=myHeaders}\nif(isJson){myHeaders.append('Content-Type','application\/json')\nrequestOptions.headers=myHeaders}\nif(body)requestOptions.body=JSON.stringify(body)\nreturn fetch(endPoint,requestOptions).then(response=>response.text()).then(result=>JSON.parse(result)).catch(error=>console.log('error',error))}\nfunction formatnumber(number,fixed=2){if(isNaN(number)||!number)return 0\nnumber=number.toFixed(fixed)\nreturn new Intl.NumberFormat().format(number)}\nasync function getHistories(){var endpoint='https:\/\/trading.greenstock.vn\/data\/api\/realtime\/intradayticker'\nvar resultHistories=await callApi(endpoint,\"POST\",!1,{'ticker':codeStock},!0)\nresultHistories=resultHistories.data;var html=\"\";var dataChart=[];for(let i=0;i<resultHistories.length;i++){if(i>500)break;let item=resultHistories[i]\nhtml+=\"<tr>\"+\"<td>\"+item.time+\"<\/td>\"+\"<td><b style='color: \"+checkDisplayColor(item.price)+\"'>\"+item.price+\"<\/b><\/td>\"+\"<td>\"+formatnumber(item?.volume)+\"<\/td>\"+\"<\/tr>\"\nif(i>10)continue}\njQuery('#historiesPrice').html(html)}\nasync function getInfoCommon(){var fundalmental=\"https:\/\/restv2.fireant.vn\/symbols\/\"+codeStock+\"\/fundamental\"\nvar priceUrl=\"https:\/\/price.vfs.com.vn\/rest\/market\/api\/getQuotesBySecCode?secCode=\"+codeStock\nvar resultFundalmental=await callApi(fundalmental,\"GET\",!0)\nvar resultPrice=await callApi(priceUrl,\"GET\",!1)\nresultPrice=resultPrice.data\nRESULT_PRICE=resultPrice\nvar dataTable=[{'color':checkDisplayColor(resultPrice?.basicPrice),'value':formatnumber(resultPrice?.basicPrice),'alias':'Tham chi\u1ebfu'},{'color':checkDisplayColor(resultPrice?.openPrice),'value':formatnumber(resultPrice?.openPrice),'alias':'M\u1edf c\u1eeda'},{'color':'','isSpecial':!0,'value':'<div class=\"pr-1 text-right\"><span style=\"color:'+checkDisplayColor(resultPrice?.lowestPrice)+'\">'+formatnumber(resultPrice?.lowestPrice)+'<\/span> - <span style=\"color:'+checkDisplayColor(resultPrice?.highestPrice)+'\">'+formatnumber(resultPrice?.highestPrice)+'<\/span><\/div>','alias':'Th\u1ea5p - cao'},{'color':'','value':formatnumber(resultPrice?.totalQty),'alias':'Kh\u1ed1i L\u01b0\u1ee3ng'},{'color':'','value':formatnumber(resultPrice?.totalAmt?resultPrice?.totalAmt\/1000000:0)+' t\u1ef7','alias':'Gi\u00e1 tr\u1ecb'},{'color':'','value':formatnumber(resultFundalmental?.avgVolume10d),'alias':'KLTB 10 ng\u00e0y'},{'color':'','value':formatnumber(resultFundalmental?.beta),'alias':'Beta'},{'color':'','value':formatnumber(resultFundalmental?.marketCap?resultFundalmental.marketCap\/1000000000:0)+\" t\u1ef7\",'alias':'Th\u1ecb gi\u00e1 v\u1ed1n'},{'color':'','value':formatnumber(resultFundalmental?.sharesOutstanding),'alias':'S\u1ed1 l\u01b0\u1ee3ng CPLH'},{'color':'','value':formatnumber(resultFundalmental?.pe),'alias':'P\/E'},{'color':'','value':formatnumber(resultFundalmental?.eps,0),'alias':'EPS'},]\nvar html='<table class=\"table table-striped\">';dataTable.map(e=>{var th=()=>{if(e?.isSpecial)return'<th>'+e?.value+'<\/th>'\nreturn'<th> <div class=\"text-right pr-1\" style=\" color:'+e?.color+'\">'+e?.value+'<\/div><\/th>'}\nhtml+='<tr>'+'<td style=\"width:75%\"> <div class=\"pl-1\">'+e.alias+'<\/td>'+th()+'<\/tr>'})\nhtml+=\"<\/table>\"\njQuery('#nav-home').html(html)\nvar dataSell=[{'label':'bestOffer','price':resultPrice?.best1OfferPriceStr,'qty':resultPrice?.best1OfferQty,'color':checkDisplayColor(resultPrice?.best1OfferPrice),'bgColor':'',},{'label':'bestOffer','price':resultPrice?.best2OfferPrice,'qty':resultPrice?.best2OfferQty,'color':checkDisplayColor(resultPrice?.best2OfferPrice),'bgColor':''},{'label':'bestOffer','price':resultPrice?.best3OfferPrice,'qty':resultPrice?.best3OfferQty,'color':checkDisplayColor(resultPrice?.best3OfferPrice),'bgColor':''}]\nvar dataBuy=[{'label':'bestOffer','price':resultPrice?.best1BidPriceStr,'qty':resultPrice?.best1BidQty,'color':checkDisplayColor(resultPrice?.best1BidPrice),'bgColor':'',},{'label':'bestOffer','price':resultPrice?.best2BidPrice,'qty':resultPrice?.best2BidQty,'color':checkDisplayColor(resultPrice?.best2BidPrice),'bgColor':'',},{'label':'bestOffer','price':resultPrice?.best3BidPrice,'qty':resultPrice?.best3BidQty,'color':checkDisplayColor(resultPrice?.best3BidPrice),'bgColor':'',}]\nlet htmlSell='';let maxWidthSell=total(dataSell)\ndataSell.map(e=>{htmlSell+='<div class=\"sc-lgpMPf bthUPl\"><div class=\"sc-hECAmk bCzOtC\" style=\"padding-left: 4px; font-weight: bold;\"><span style=\"padding: 4px; color: '+e.color+';\">'+e.price+'&nbsp;<\/span><\/div><div class=\"sc-ldxQMJ dacVUY\" style=\"justify-content: flex-end;\"><span style=\"padding: 4px;\">'+formatnumber(e.qty)+'&nbsp;<\/span><\/div><div style=\"position: absolute; z-index: 0; top: 0px; bottom: 0px; left: 2px; width:'+((e.qty\/maxWidthSell)*100)+'%; background-color:'+checkDisplayColor(e.price)+';opacity:0.5\"><\/div><\/div>'})\nlet htmlBuy='';let maxWidthBuy=total(dataBuy)\ndataBuy.map(e=>{htmlBuy+='<div class=\"sc-lgpMPf bthUPl\"><div class=\"sc-ldxQMJ dacVUY\"><span style=\"padding: 4px;\">&nbsp;'+formatnumber(e.qty)+'<\/span><\/div><div class=\"sc-hECAmk bCzOtC\" style=\"justify-content: flex-end;padding-right: 4px;font-weight: bold;\"><span style=\"padding: 4px; color: '+checkDisplayColor(e.price)+';\">&nbsp;'+(e.price)+'<\/span><\/div><div style=\"position: absolute;z-index: 0;top: 0px;bottom: 0px;right: 2px;width: '+((e.qty\/maxWidthBuy)*100)+'%;background-color: '+checkDisplayColor(e.price)+';opacity:0.5\"><\/div><\/div>'})\njQuery('#totalQty').text(formatnumber(resultPrice.totalQty))\njQuery('#widgetSellStock').html(htmlSell)\njQuery('#widgetBuyStock').html(htmlBuy)}\nfunction checkDisplayColor(price=0){return checkColor(price,RESULT_PRICE?.ceilingPrice,RESULT_PRICE?.floorPrice,RESULT_PRICE?.basicPrice)}\njQuery('.item-code-btn').click(async function(){codeStock=jQuery(this).attr('data-code')\njQuery('#khang_cu_manh').text(jQuery(this).attr('data-price-down'))\njQuery('#ho_tro_manh').text(jQuery(this).attr('data-price-up'))\nawait getInfoCommon()})\nfunction total(array){var total=0;array.map(e=>{total+=e.qty})\nreturn total}\nasync function chartPrice(){var endpoint=\" https:\/\/trading.greenstock.vn\/data\/api\/realtime\/intradaytickerbyprice\"\nvar resultChart=await callApi(endpoint,\"POST\",!1,{ticker:codeStock},!0)\nresultChart=resultChart.data\nvar dataChart=[]\nresultChart.map(item=>{dataChart.push({y:item.volume\/1000,label:formatnumber(item?.price),indexLabel:formatnumber(item?.price),color:checkDisplayColor(item?.price)})})\nvar options={animationEnabled:!0,backgroundColor:\"#f4f6f9\",height:700,axisY:{tickThickness:1,lineThickness:1,includeZero:!0,gridThickness:1,gridColor:\"#bbb\",gridDashType:\"dash\",},axisX:{gridDashType:\"dash\",gridColor:\"#bbb\",tickThickness:1,includeZero:!0,lineThickness:1,labelFontSize:15,labelFontColor:\"#000\"},toolTip:{borderColor:\"#000000c7\",backgroundColor:\"#000000c7\",fontColor:\"#fff\"},data:[{indexLabelFontSize:10,toolTipContent:\"<span>M\u1ee9c gi\u00e1 :{indexLabel}<\/span> <br> <span>T\u1ed5ng KL: <strong>{y}<\/strong><\/span>\",indexLabelPlacement:\"\",indexLabelFontColor:\"#ffffff00\",indexLabelFontWeight:100,type:\"bar\",dataPoints:dataChart}]};jQuery(\"#chartContainer\").CanvasJSChart(options)}\nasync function statistical(){var currentDate=new Date()\nvar startDate=subtractMonths(new Date(),1)\nvar endPoint=\"https:\/\/restv2.fireant.vn\/symbols\/\"+codeStock+\"\/historical-quotes?startDate=\"+formatDate(startDate)+\"&endDate=\"+formatDate(currentDate)+\"&offset=0&limit=10\"\nvar result=await callApi(endPoint,\"GET\",!0,null,!1)\nvar dataChart=[],htmlVolume='',htmlPrice='';const totalColor=(total)=>{if(total==0)return\"#000\";if(total>0)return COLOR_GREEN;if(total<0)return COLOR_RED}\nfor(let i=0;i<result.length;i++){let item=result[i]\nif(i===0){console.log(item?.buyForeignQuantity);htmlVolume+=\"<tr>\"+\"<td> <b class='pl-2' style='color:\"+COLOR_GREEN+\"'>\"+formatnumber(item?.buyForeignQuantity)+\"<b><\/td>\"+\"<td> <b class='pl-2' style='color:\"+COLOR_RED+\"'>\"+formatnumber(item?.sellForeignQuantity)+\"<\/b><\/td>\"+\"<td> <b class='pl-2' style='color:\"+(totalColor(item?.buyForeignQuantity-item?.sellForeignQuantity))+\"'>\"+(formatnumber(item?.buyForeignQuantity-item?.sellForeignQuantity))+\" <\/b><\/td><\/tr>\";htmlPrice+=\"<tr>\"+\"<td> <b class='pl-2' style='color:\"+COLOR_GREEN+\"'>\"+formatnumber(item?.buyForeignValue\/1000000000)+\" t\u1ef7 <\/b><\/td>\"+\"<td> <b class='pl-2' style='color:\"+COLOR_RED+\"'>\"+formatnumber(item?.sellForeignValue\/1000000000)+\" t\u1ef7<\/b><\/td>\"+\"<td> <b class='pl-2' style='color:\"+(totalColor(item?.buyForeignValue-item?.sellForeignValue))+\"'>\"+((formatnumber((item?.buyForeignValue-item?.sellForeignValue)\/1000000000)))+\" t\u1ef7<\/b><\/td><\/tr>\"}\nlet date=new Date(item.date)\nvar dataY=(item?.buyForeignValue-item?.sellForeignValue)\/1000000000\ndataChart.push({label:(item?.buyForeignValue-item?.sellForeignValue)?formatMoth(date):'  ',y:Number.parseFloat(dataY.toFixed(2)),color:totalColor(item?.buyForeignValue-item?.sellForeignValue)},)}\nvar options={backgroundColor:\"#f4f6f9\",axisY:{tickThickness:-1,lineThickness:0,includeZero:!0,gridThickness:1,gridColor:\"#bbb\",gridDashType:\"dash\",},toolTip:{content:\"<span>Ng\u00e0y mua: {label} <\/span><br><span> Gi\u00e1 tr\u1ecb mua d\u00f2ng: {y}<\/span>\",borderColor:\"#000000c7\",backgroundColor:\"#000000c7\",fontColor:\"#fff\"},data:[{type:\"column\",dataPoints:dataChart.reverse()}]};jQuery('#htmlVolume').html(htmlVolume)\njQuery('#htmlPrice').html(htmlPrice)\njQuery(\"#chart-statistical\").CanvasJSChart(options)}\nfunction subtractMonths(date,months){date.setMonth(date.getMonth()-months);return date}\nfunction formatDate(date=new Date()){const year=date.toLocaleString('default',{year:'numeric'});const month=date.toLocaleString('default',{month:'2-digit'});const day=date.toLocaleString('default',{day:'2-digit'});return[year,month,day].join('-')}\nfunction formatMoth(date=new Date()){const month=date.toLocaleString('default',{month:'2-digit'});const day=date.toLocaleString('default',{day:'2-digit'});return[day,month].join('\/')}\nfunction checkColor(lastPrice=0,ceilingPrice=0,floorPrice=0,basicPrice=0){if(lastPrice>=ceilingPrice)return COLOR_PURPLE;if(lastPrice<=floorPrice)return COLOR_BLUE_ACCESS;if(lastPrice==basicPrice)return COLOR_YELLOW;if(basicPrice<lastPrice&&lastPrice<ceilingPrice)return COLOR_GREEN;if(floorPrice<lastPrice&&lastPrice<basicPrice)return COLOR_RED;return COLOR_PURPLE};\n","status":true}